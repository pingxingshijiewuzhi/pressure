(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/queryAnalysisdata/queryAnalysisdata"],{"0275":function(t,e,a){},"0bf4":function(t,e,a){"use strict";a.r(e);var i=a("8ccb"),n=a("7287");for(var s in n)"default"!==s&&function(t){a.d(e,t,(function(){return n[t]}))}(s);a("52d0");var c,r=a("f0c5"),o=Object(r["a"])(n["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],c);e["default"]=o.exports},"29f9":function(t,e,a){"use strict";(function(t){a("aee2"),a("921b");i(a("66fd"));var e=i(a("0bf4"));function i(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,a("6e42")["createPage"])},"52d0":function(t,e,a){"use strict";var i=a("0275"),n=a.n(i);n.a},7287:function(t,e,a){"use strict";a.r(e);var i=a("fa91"),n=a.n(i);for(var s in i)"default"!==s&&function(t){a.d(e,t,(function(){return i[t]}))}(s);e["default"]=n.a},"8ccb":function(t,e,a){"use strict";var i,n=function(){var t=this,e=t.$createElement,a=(t._self._c,t.__map(t.devicesList,(function(e,a){var i=Math.max(100+e.RSSI,0);return{$orig:t.__get_orig(e),g0:i}})));t.$mp.data=Object.assign({},{$root:{l0:a}})},s=[];a.d(e,"b",(function(){return n})),a.d(e,"c",(function(){return s})),a.d(e,"a",(function(){return i}))},fa91:function(t,e,a){"use strict";(function(t,i){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=d(a("4795")),s=d(a("bc17")),c=d(a("6fd8")),r=d(a("da65")),o=(d(a("4877")),d(a("a32c")));function d(t){return t&&t.__esModule?t:{default:t}}function u(t,e,a,i,n,s,c){try{var r=t[s](c),o=r.value}catch(d){return void a(d)}r.done?e(o):Promise.resolve(o).then(i,n)}function l(t){return function(){var e=this,a=arguments;return new Promise((function(i,n){var s=t.apply(e,a);function c(t){u(s,i,n,c,r,"next",t)}function r(t){u(s,i,n,c,r,"throw",t)}c(void 0)}))}}var h=function(){a.e("pages/hint/deletehint").then(function(){return resolve(a("52d1"))}.bind(null,a)).catch(a.oe)},f=new o.default,v={components:{deleteHint:h},data:function(){return{modifyStatus:!0,seeagain:!0,baseUrl:this.$common.baseUrl,isShow:!1,title:"是否删除数据",datalist:[],validdatalist:[],commonlist:[{id:0,time:"15:22:10",L:"",R:"99",checked:!1}],garbagedatalist:[],printstatus:!1,canprint:!0,Inv:1,type:"",pickerDate:"",loadMoreText:"加载中...",showLoadMore:!1,page:1,limit:20,lisize:0,langch:{chakanbaogao:"查看动态报告",chakanstaticbaogao:"查看静态报告",printreport:"打印报告",printing:"打印中",shanchu:"删除",shijian:"时间",zuijia:"最佳数据",youxiao:"有效数据",laji:"垃圾数据",quantian:"全天数据",common:"一般数据"},langen:{chakanbaogao:"View report",chakanstaticbaogao:"Static View report",printreport:"printreport",shanchu:"delete",printing:"printing",shijian:"time",zuijia:"optimum",youxiao:"Effective",laji:"garbage",quantian:"All day",common:"common"},hour:(new Date).getHours(),min:(new Date).getMinutes(),sec:(new Date).getSeconds(),year:(new Date).getFullYear(),week:["日","一","二","三","四","五","六"][(new Date).getDay()],month:(new Date).getMonth()+1,day:(new Date).getDate(),avatar:t.getStorageSync("userinfo").avatar,username:t.getStorageSync("userinfo").username,langtype:"",printdata:[],isOpenBle:!1,devicesList:[],serviceList:[],deviceId:"",serviceId:"",notifyId:""}},onShow:function(){for(var t=0;t<this.datalist.length;t++)this.datalist[t].checked=!1;for(t=0;t<this.validdatalist.length;t++)this.validdatalist[t].checked=!1},onLoad:function(e){this.langtype=t.getStorageSync("lang")?t.getStorageSync("lang"):"CH",this.getTime(),this.pickerDate=e.time,this.searchData(),t.getStorageSync("deviceId")&&t.getStorageSync("serviceId")&&(this.printstatus=!0)},onUnload:function(){this.data=[],this.loadMoreText="加载更多",this.showLoadMore=!1},methods:{scrolltolower:function(){var t=this;this.showLoadMore=!0,setTimeout((function(){20==t.lisize?(t.page++,t.searchData()):(t.loadMoreText="暂无更多",t.showLoadMore=!1)}),1e3)},gocontrolpanel:function(){t.reLaunch({url:"/pages/personalCenter/personalCenter"})},back:function(){t.navigateBack({delta:1})},searchData:function(){var e=this;0==this.Inv&&(this.type=1),1==this.Inv&&(this.type=2),2==this.Inv&&(this.type=3);var a={time:this.pickerDate,page:this.page,limit:this.limit,type:this.type};this.$common.requests("/api/index/getoneday",a).then((function(a){if(e.showLoadMore=!1,1==a.data.code){if(e.lisize=a.data.data.length,0==e.lisize)return;1==e.page?(0==e.Inv&&(e.datalist=a.data.data),1==e.Inv&&(e.validdatalist=a.data.data),2==e.Inv&&(e.garbagedatalist=a.data.data)):(0==e.Inv&&(e.datalist=e.datalist.concat(a.data.data)),1==e.Inv&&(e.validdatalist=e.validdatalist.concat(a.data.data)),2==e.Inv&&(e.garbagedatalist=e.garbagedatalist.concat(a.data.data)))}0==a.data.code&&t.showToast({title:a.data.msg,icon:"none"})}))},changetitle:function(t){this.Inv=t,this.page=1,this.searchData()},checkboxChange:function(t){this.datalist[t].checked=!this.datalist[t].checked},checkboxChange1:function(t){this.validdatalist[t].checked=!this.validdatalist[t].checked},checkboxChange2:function(t){this.garbagedatalist[t].checked=!this.garbagedatalist[t].checked},checkboxChange3:function(t){this.commonlist[t].checked=!this.commonlist[t].checked},deleteclick:function(){this.isShow=!this.isShow},closemod:function(){this.isShow=!1},cancleclick:function(){this.isShow=!this.isShow},tureclick:function(){var e=this;this.isShow=!this.isShow;var a="";0==this.Inv&&this.datalist.forEach((function(t){1==t.checked&&(a+=t.id+",")})),1==this.Inv&&this.validdatalist.forEach((function(t){1==t.checked&&(a+=t.id+",")})),2==this.Inv&&this.garbagedatalist.forEach((function(t){1==t.checked&&(a+=t.id+",")})),a=a.substring(0,a.length-1),""==a&&(0==this.Inv&&this.datalist.forEach((function(t){a+=t.id+","})),1==this.Inv&&this.validdatalist.forEach((function(t){a+=t.id+","})));var i={ids:a};this.$common.requests("/api/record/del_record",i).then((function(a){t.showToast({title:a.data.msg,duration:1e3}),e.searchData()}))},lookreport:function(){var e="";0==this.Inv&&(this.datalist.forEach((function(t){1==t.checked&&(e+=t.id+",")})),e=e.substring(0,e.length-1),""==e&&this.datalist.forEach((function(t){0==t.checked&&(e+=t.id+",")})),t.navigateTo({url:"../bestlinechart/bestlinechart?checkedid="+e+"&pickerDate="+this.pickerDate+"&Inv=0"})),1==this.Inv&&(this.validdatalist.forEach((function(t){1==t.checked&&(e+=t.id+",")})),e=e.substring(0,e.length-1),""==e&&this.validdatalist.forEach((function(t){0==t.checked&&(e+=t.id+",")})),t.navigateTo({url:"../linechart/linechart?checkedid="+e+"&pickerDate="+this.pickerDate+"&Inv=1"}))},getTime:function(){var t=this;setInterval((function(){var e=new Date;t.min=e.getMinutes(),t.hour=e.getHours(),t.sec=e.getSeconds(),t.year=e.getFullYear(),t.month=e.getMonth()+1;var a=["日","一","二","三","四","五","六"];t.week=a[e.getDay()],t.day=e.getDate(),t.min=e.getMinutes()}),1e3)},startBluetoothDeviceDiscovery:function(){var e=this;t.showLoading({title:"蓝牙搜索中"});var a=this;a.devicesList=[],setTimeout((function(){t.startBluetoothDevicesDiscovery({success:function(n){t.onBluetoothDeviceFound((function(n){i("log","发现设备: "+JSON.stringify(n)," at pages\\queryAnalysisdata\\queryAnalysisdata.vue:681"),a.devicesList.some((function(t){return t.deviceId===n.devices[0].deviceId}))||(a.devicesList.push(n.devices[0]),e.seeagain&&(e.modifyStatus=!0,t.hideLoading()))}))},fail:function(e){t.hideLoading(),a.showToast("搜索设备失败"+JSON.stringify(err))}})}),200)},select_deviceId:function(e){var a=this;return l(n.default.mark((function s(){var c;return n.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.hideLoading(),a.deviceId=e.deviceId,f.deviceId=e.deviceId,t.setStorageSync("deviceId",f.deviceId),a.serviceList=[],n.prev=5,n.next=8,f.createBLEConnection();case 8:return n.sent,n.next=11,f.getBLEDeviceServices();case 11:c=n.sent,i("log","获取服务: "+JSON.stringify(c)," at pages\\queryAnalysisdata\\queryAnalysisdata.vue:717"),a.serviceList=c,a.select_service(a.serviceList[2]),n.next=20;break;case 17:n.prev=17,n.t0=n["catch"](5),i("log","e: "+JSON.stringify(n.t0)," at pages\\queryAnalysisdata\\queryAnalysisdata.vue:727");case 20:case"end":return n.stop()}}),s,null,[[5,17]])})))()},select_service:function(e){var a=this;return l(n.default.mark((function i(){return n.default.wrap((function(i){while(1)switch(i.prev=i.next){case 0:a.modifyStatus=!1,a.seeagain=!1,a,f.serviceId=e.uuid,t.setStorageSync("serviceId",e.uuid),a.printstatus=!0,a.$api.msg("请再按一次打印");case 7:case"end":return i.stop()}}),i)})))()},printbluetooth:function(){var e=this;return l(n.default.mark((function a(){var s,c,r,o,d;return n.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,f.openBluetoothAdapter();case 2:if(t.getStorageSync("pressuredeviceId")&&(s=t.getStorageSync("pressuredeviceId"),t.closeBLEConnection({deviceId:s,success:function(t){i("log",t," at pages\\queryAnalysisdata\\queryAnalysisdata.vue:772")}})),c=[],0==e.Inv)if(e.datalist.length>20)for(r=0;r<20;r++)c.push(e.datalist[r]);else e.datalist.forEach((function(t){1==t.checked&&c.push(t)}));if(1==e.Inv)if(e.validdatalist.length>20)for(r=0;r<20;r++)c.push(e.validdatalist[r]);else e.validdatalist.forEach((function(t){1==t.checked&&c.push(t)}));if(0==c.length){if(0==e.Inv)if(e.datalist.length>20)for(r=0;r<20;r++)c.push(e.datalist[r]);else e.datalist.forEach((function(t){c.push(t)}));if(1==e.Inv)if(e.validdatalist.length>20)for(r=0;r<20;r++)c.push(e.validdatalist[r]);else e.validdatalist.forEach((function(t){c.push(t)}))}for(i("log",c,"打印数据"," at pages\\queryAnalysisdata\\queryAnalysisdata.vue:834"),o=0;o<c.length;o++)0==c[o].l&&(c[o].l=" "),0==c[o].r&&(c[o].r=" ");if(i("log",c,"处理后数据"," at pages\\queryAnalysisdata\\queryAnalysisdata.vue:843"),e.printdata=c,d=e,i("log",t.getStorageSync("deviceId"),"是否已连接设备id"," at pages\\queryAnalysisdata\\queryAnalysisdata.vue:850"),i("log",t.getStorageSync("serviceId"),"是否已连接服务id"," at pages\\queryAnalysisdata\\queryAnalysisdata.vue:851"),!t.getStorageSync("deviceId")||!t.getStorageSync("serviceId")){a.next=22;break}return e.deviceId=t.getStorageSync("deviceId"),e.serviceId=t.getStorageSync("serviceId"),a.next=19,f.reconnect();case 19:e.canprint?(e.canprint=!1,setTimeout((function(){d.mywriteBLECharacteristicValue(),d.canprint=!0}),3e3)):e.$api.msg("请稍后再试"),a.next=23;break;case 22:e.startBluetoothDeviceDiscovery();case 23:case"end":return a.stop()}}),a)})))()},mywriteBLECharacteristicValue:function(){var t=this;return l(n.default.mark((function e(){var a,i,o,d,u,l,h;return n.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:for(a=t.username,i=t.printdata,o=t.pickerDate,d=t.printdata.length,u=new s.default,u.print(r.default.formatTime(new Date)).print(c.default.fillLine()).print(c.default.inline("NAME",a)).print(c.default.inline("DATE",o)).print(c.default.fillLine()).setSize(2,2).print("TIME    L    R").println(),l=0;l<d;l++)u.setSize(1,1).print("".concat(i[l].createtime,"\t").concat(i[l].l,"\t  ").concat(i[l].r));return u.print("").print(""),e.next=10,u.buffer();case 10:return h=e.sent,e.next=13,t.printbuffs(h);case 13:case"end":return e.stop()}}),e)})))()},printbuffs:function(t){for(var e=20,a=20,i=0,n=0,s=t.byteLength;i<s;i+=e,n++){var c=t.slice(i,i+e<=s?i+e:s);setTimeout(this.printbuff,n*a,c)}},printbuff:function(t){f.writeBLECharacteristicValue(t)},canclemodfity:function(){this.modifyStatus=!1}}};e.default=v}).call(this,a("6e42")["default"],a("0de9")["default"])}},[["29f9","common/runtime","common/vendor"]]]);