(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/alldayData/alldayData"],{"37f2":function(t,a,e){"use strict";e.r(a);var i=e("d589"),n=e("d574");for(var s in n)"default"!==s&&function(t){e.d(a,t,(function(){return n[t]}))}(s);e("b0e5");var c,r=e("f0c5"),o=Object(r["a"])(n["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],c);a["default"]=o.exports},"56c2":function(t,a,e){},a289:function(t,a,e){"use strict";(function(t){e("aee2"),e("921b");i(e("66fd"));var a=i(e("37f2"));function i(t){return t&&t.__esModule?t:{default:t}}t(a.default)}).call(this,e("6e42")["createPage"])},b0e5:function(t,a,e){"use strict";var i=e("56c2"),n=e.n(i);n.a},cb90:function(t,a,e){"use strict";(function(t,i){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var n=d(e("4795")),s=d(e("bc17")),c=d(e("6fd8")),r=d(e("da65")),o=(d(e("4877")),d(e("a32c")));function d(t){return t&&t.__esModule?t:{default:t}}function l(t,a,e,i,n,s,c){try{var r=t[s](c),o=r.value}catch(d){return void e(d)}r.done?a(o):Promise.resolve(o).then(i,n)}function u(t){return function(){var a=this,e=arguments;return new Promise((function(i,n){var s=t.apply(a,e);function c(t){l(s,i,n,c,r,"next",t)}function r(t){l(s,i,n,c,r,"throw",t)}c(void 0)}))}}var h=function(){e.e("pages/hint/deletehint").then(function(){return resolve(e("52d1"))}.bind(null,e)).catch(e.oe)},f=new o.default,v={components:{deleteHint:h},data:function(){return{modifyStatus:!0,seeagain:!0,isShow:!1,title:"是否删除数据",printstatus:!1,canprint:!0,baseUrl:this.$common.baseUrl,datalist:[],validdatalist:[],commonlist:[],garbagedatalist:[],Inv:0,type:"",loadMoreText:"加载中...",showLoadMore:!1,page:1,limit:20,lisize:0,langch:{chakanbaogao:"查看动态报告",chakanstaticbaogao:"查看静态报告",printreport:"打印报告",printing:"打印中",shanchu:"删除",shijian:"时间",zuijia:"最佳数据",youxiao:"有效数据",laji:"垃圾数据",quantian:"全天数据",common:"一般数据"},langen:{chakanbaogao:"View report",chakanstaticbaogao:"Static View report",printreport:"printreport",printing:"printing",shanchu:"delete",shijian:"time",zuijia:"optimum",youxiao:"Effective",laji:"garbage",quantian:"All day",common:"common"},langtype:"",year:(new Date).getFullYear(),week:["日","一","二","三","四","五","六"][(new Date).getDay()],month:(new Date).getMonth()+1,day:(new Date).getDate(),avatar:t.getStorageSync("userinfo").avatar,username:t.getStorageSync("userinfo").username,printdata:[],isOpenBle:!1,devicesList:[],serviceList:[],deviceId:"",serviceId:"",notifyId:""}},onShow:function(){this.langtype=t.getStorageSync("lang")?t.getStorageSync("lang"):"CH",this.getTime(),this._searchtodayData()},onLoad:function(){t.getStorageSync("deviceId")&&t.getStorageSync("serviceId")&&(this.printstatus=!0)},onUnload:function(){this.data=[],this.loadMoreText="加载更多",this.showLoadMore=!1},methods:{startBluetoothDeviceDiscovery:function(){var a=this;t.showLoading({title:"蓝牙搜索中"});var e=this;e.devicesList=[],setTimeout((function(){t.startBluetoothDevicesDiscovery({success:function(n){t.onBluetoothDeviceFound((function(n){i("log","发现设备: "+JSON.stringify(n)," at pages\\alldayData\\alldayData.vue:341"),e.devicesList.some((function(t){return t.deviceId===n.devices[0].deviceId}))||(e.devicesList.push(n.devices[0]),a.seeagain&&(a.modifyStatus=!0,t.hideLoading()))}))},fail:function(a){t.hideLoading(),e.showToast("搜索设备失败"+JSON.stringify(err))}})}),200)},select_deviceId:function(a){var e=this;return u(n.default.mark((function s(){var c;return n.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return e.deviceId=a.deviceId,i("log",a.deviceId,"点击获取的deviceId"," at pages\\alldayData\\alldayData.vue:364"),f.deviceId=a.deviceId,t.setStorageSync("deviceId",f.deviceId),e.serviceList=[],n.prev=5,n.next=8,f.createBLEConnection();case 8:return n.sent,n.next=11,f.getBLEDeviceServices();case 11:c=n.sent,i("log","获取服务: "+JSON.stringify(c)," at pages\\alldayData\\alldayData.vue:376"),e.serviceList=c,i("log",e.serviceList,"获取设备"," at pages\\alldayData\\alldayData.vue:379"),e.select_service(e.serviceList[2]),n.next=21;break;case 18:n.prev=18,n.t0=n["catch"](5),i("log","e: "+JSON.stringify(n.t0)," at pages\\alldayData\\alldayData.vue:386");case 21:case"end":return n.stop()}}),s,null,[[5,18]])})))()},select_service:function(a){var e=this;return u(n.default.mark((function i(){return n.default.wrap((function(i){while(1)switch(i.prev=i.next){case 0:e.modifyStatus=!1,e.seeagain=!1,e,f.serviceId=a.uuid,t.setStorageSync("serviceId",a.uuid),e.printstatus=!0,e.$api.msg("请再按一次打印");case 7:case"end":return i.stop()}}),i)})))()},scrolltolower:function(){var t=this;this.showLoadMore=!0,setTimeout((function(){20==t.lisize?(t.page++,t._searchtodayData()):(t.loadMoreText="暂无更多",t.showLoadMore=!1)}),1e3)},gocontrolpanel:function(){t.reLaunch({url:"/pages/personalCenter/personalCenter"})},back:function(){t.navigateTo({url:"../realtime/realtime"})},getTime:function(){var t=this;setInterval((function(){var a=new Date;t.year=a.getFullYear(),t.month=a.getMonth()+1;var e=["日","一","二","三","四","五","六"];t.week=e[a.getDay()],t.day=a.getDate(),t.min=a.getMinutes()}),1e3)},_searchtodayData:function(){var a=this;0==this.Inv&&(this.type=1),1==this.Inv&&(this.type=2),2==this.Inv&&(this.type=3);var e={time:this.year+"-"+this.month+"-"+this.day,page:this.page,limit:this.limit,type:this.type};this.$common.requests("/api/index/getoneday",e).then((function(e){a.showLoadMore=!1,1==e.data.code&&(a.lisize=e.data.data.length,1==a.page?(0==a.Inv&&(i("log",a.datalist,"一页"," at pages\\alldayData\\alldayData.vue:498"),a.datalist=e.data.data),1==a.Inv&&(i("log",a.validdatalist,"一页"," at pages\\alldayData\\alldayData.vue:502"),a.validdatalist=e.data.data),2==a.Inv&&(a.garbagedatalist=e.data.data)):(0==a.Inv&&(a.datalist=a.datalist.concat(e.data.data)),1==a.Inv&&(a.validdatalist=a.validdatalist.concat(e.data.data)),2==a.Inv&&(a.garbagedatalist=a.garbagedatalist.concat(e.data.data)))),0==e.data.code&&t.showToast({title:e.data.msg,icon:"none"})}))},changetitle:function(t){this.Inv=t,this.page=1,this._searchtodayData()},checkboxChange:function(t){this.datalist[t].checked=!this.datalist[t].checked},checkboxChange1:function(t){this.validdatalist[t].checked=!this.validdatalist[t].checked},checkboxChange2:function(t){this.garbagedatalist[t].checked=!this.garbagedatalist[t].checked},checkboxChange3:function(t){this.commonlist[t].checked=!this.commonlist[t].checked},lookreport:function(){var a="";0==this.Inv&&this.datalist.forEach((function(t){1==t.checked&&(a+=t.id+",")})),1==this.Inv&&this.validdatalist.forEach((function(t){1==t.checked&&(a+=t.id+",")})),a=a.substring(0,a.length-1),i("log",a,"选中的id"," at pages\\alldayData\\alldayData.vue:582"),""==a&&(0==this.Inv&&this.datalist.forEach((function(t){a+=t.id+","})),1==this.Inv&&this.validdatalist.forEach((function(t){a+=t.id+","}))),0==this.Inv&&t.navigateTo({url:"../bestlinechart/bestlinechart?checkedid="+a+"&pickerDate="+this.year+"-"+this.month+"-"+this.day+"&Inv=0"}),1==this.Inv&&t.navigateTo({url:"../linechart/linechart?checkedid="+a+"&pickerDate="+this.year+"-"+this.month+"-"+this.day+"&Inv=1"})},printbluetooth:function(){var a=this;return u(n.default.mark((function e(){var s,c,r,o,d;return n.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,f.openBluetoothAdapter();case 2:if(t.getStorageSync("pressuredeviceId")&&(s=t.getStorageSync("pressuredeviceId"),t.closeBLEConnection({deviceId:s,success:function(t){i("log",t," at pages\\alldayData\\alldayData.vue:624")}})),c=[],0==a.Inv)if(a.datalist.length>20)for(r=0;r<20;r++)c.push(a.datalist[r]);else a.datalist.forEach((function(t){1==t.checked&&c.push(t)}));if(1==a.Inv)if(a.validdatalist.length>20)for(r=0;r<20;r++)c.push(a.validdatalist[r]);else a.validdatalist.forEach((function(t){1==t.checked&&c.push(t)}));if(0==c.length){if(0==a.Inv)if(a.datalist.length>20)for(r=0;r<20;r++)c.push(a.datalist[r]);else a.datalist.forEach((function(t){c.push(t)}));if(1==a.Inv)if(a.validdatalist.length>20)for(r=0;r<20;r++)c.push(a.validdatalist[r]);else a.validdatalist.forEach((function(t){c.push(t)}))}for(i("log",c,"打印数据"," at pages\\alldayData\\alldayData.vue:686"),o=0;o<c.length;o++)0==c[o].l&&(c[o].l=" "),0==c[o].r&&(c[o].r=" ");if(i("log",c,"处理后数据"," at pages\\alldayData\\alldayData.vue:695"),a.printdata=c,d=a,i("log",t.getStorageSync("deviceId"),"是否已连接设备id"," at pages\\alldayData\\alldayData.vue:702"),i("log",t.getStorageSync("serviceId"),"是否已连接服务id"," at pages\\alldayData\\alldayData.vue:703"),!t.getStorageSync("deviceId")||!t.getStorageSync("serviceId")){e.next=22;break}return a.deviceId=t.getStorageSync("deviceId"),a.serviceId=t.getStorageSync("serviceId"),e.next=19,f.reconnect();case 19:a.canprint?(a.canprint=!1,setTimeout((function(){d.mywriteBLECharacteristicValue(),d.canprint=!0}),3e3)):a.$api.msg("请稍后再试"),e.next=23;break;case 22:a.startBluetoothDeviceDiscovery();case 23:case"end":return e.stop()}}),e)})))()},mywriteBLECharacteristicValue:function(){var t=this;return u(n.default.mark((function a(){var e,i,o,d,l,u;return n.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:for(e=t.username,i=t.printdata,o=t.printdata.length,d=new s.default,d.print(r.default.formatTime(new Date)).print(c.default.fillLine()).print(c.default.inline("NAME",e)).print(c.default.inline("DATE",r.default.formatTime(new Date))).print(c.default.fillLine()).setSize(2,2).print("TIME    L    R").println(),l=0;l<o;l++)d.setSize(1,1).print("".concat(i[l].createtime,"\t").concat(i[l].l,"\t  ").concat(i[l].r));return d.print("").print(""),u=d.buffer(),a.next=10,t.printbuffs(u);case 10:case"end":return a.stop()}}),a)})))()},printbuffs:function(t){for(var a=20,e=20,i=0,n=0,s=t.byteLength;i<s;i+=a,n++){var c=t.slice(i,i+a<=s?i+a:s);setTimeout(this.printbuff,n*e,c)}},printbuff:function(t){f.writeBLECharacteristicValue(t)},deleteclick:function(){this.isShow=!this.isShow},closemod:function(){this.isShow=!1},cancleclick:function(){this.isShow=!this.isShow},tureclick:function(){var a=this;this.isShow=!this.isShow;var e="";0==this.Inv&&this.datalist.forEach((function(t){1==t.checked&&(e+=t.id+",")})),1==this.Inv&&this.validdatalist.forEach((function(t){1==t.checked&&(e+=t.id+",")})),2==this.Inv&&this.garbagedatalist.forEach((function(t){1==t.checked&&(e+=t.id+",")})),e=e.substring(0,e.length-1),""==e&&(0==this.Inv&&this.datalist.forEach((function(t){e+=t.id+","})),1==this.Inv&&this.validdatalist.forEach((function(t){e+=t.id+","})));var i={ids:e};this.$common.requests("/api/record/del_record",i).then((function(e){t.showToast({title:e.data.msg,duration:1e3}),a.page=1,a._searchtodayData()}))},canclemodfity:function(){this.modifyStatus=!1}}};a.default=v}).call(this,e("6e42")["default"],e("0de9")["default"])},d574:function(t,a,e){"use strict";e.r(a);var i=e("cb90"),n=e.n(i);for(var s in i)"default"!==s&&function(t){e.d(a,t,(function(){return i[t]}))}(s);a["default"]=n.a},d589:function(t,a,e){"use strict";var i,n=function(){var t=this,a=t.$createElement,e=(t._self._c,t.__map(t.devicesList,(function(a,e){var i=Math.max(100+a.RSSI,0);return{$orig:t.__get_orig(a),g0:i}})));t.$mp.data=Object.assign({},{$root:{l0:e}})},s=[];e.d(a,"b",(function(){return n})),e.d(a,"c",(function(){return s})),e.d(a,"a",(function(){return i}))}},[["a289","common/runtime","common/vendor"]]]);